<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="utf-8" />
  <link rel="stylesheet" th:href="@{/css/header/base.css}" />
  <link rel="stylesheet" th:href="@{/css/header/header.css}" />
  <link rel="stylesheet" th:href="@{/css/header/token.css}" />
</head>
<body>

<!-- ‚úÖ ÏïåÎ¶º Í∏∞Îä• Ïä§ÌÅ¨Î¶ΩÌä∏ fragment ÏÇΩÏûÖ -->
<th:replace="~{fragments/common/alert-script :: alert-script}" />

<div th:fragment="header">
  <div class="div-wrapper">
    <div class="div">

      <!-- ‚úÖ Ï¢åÏ∏° Î°úÍ≥† ÏòÅÏó≠ -->
      <div class="group">
        <a th:href="${#authorization.expression('hasRole(''ROLE_ADMIN'')')} ? @{/admin/users} : @{/user/main}">
          <div class="vector">üìä</div>
        </a>
        <span class="logo-text">CodeMap</span>
      </div>

      <!-- ‚úÖ Ï§ëÏïô ÌéòÏù¥ÏßÄ Ï†úÎ™© ÏòÅÏó≠ -->
      <h1 class="page-title"></h1>

      <!-- ‚úÖ Ïö∞Ï∏° ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ ÏòÅÏó≠ -->
      <div class="auto-layout">

        <!-- ÏïåÎ¶º ÏïÑÏù¥ÏΩò -->
        <div class="notification-container">
          <div id="notification-icon" class="notification"></div>

          <!-- ÏïåÎ¶º Î©îÏãúÏßÄ ÌåùÏóÖ -->
          <div id="notification-popup" class="notification-popup" style="display: none;">
            <p th:each="todo : ${alertTodos}" th:text="${todo.title} + ' ÏãúÏûë 10Î∂Ñ Ï†ÑÏûÖÎãàÎã§.'"></p>
          </div>
        </div>

        <!-- ÏÇ¨Ïö©Ïûê ÏïÑÎ∞îÌÉÄ -->
        <div class="user-avatar" th:text="${user != null ? #strings.substring(user.nickname, 0, 1) : ''}">ÍπÄ</div>

        <!-- ÏÇ¨Ïö©Ïûê ÎãâÎÑ§ÏûÑ -->
        <span th:text="${user != null ? user.nickname : ''}">ÏÇ¨Ïö©Ïûê</span>

        <!-- Î°úÍ∑∏ÏïÑÏõÉ Î≤ÑÌäº -->
        <div class="style-filled">
          <form th:action="@{/user/logout}" method="post" style="margin-left: 1rem;">
            <button type="submit" class="logout-button">Î°úÍ∑∏ÏïÑÏõÉ</button>
          </form>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- ‚úÖ Ïä§ÌÅ¨Î¶ΩÌä∏: Ï†úÎ™© ÏÑ§Ï†ïÎßå Ïú†ÏßÄ -->
<script th:inline="javascript">
  /*<![CDATA[*/
  window.addEventListener('load', () => {
    const pageTitle = document.querySelector('.page-title');
    const currentPath = window.location.pathname;

    if (pageTitle) {
      let title = '';
      if (currentPath.includes('/user/main')) title = 'ÎåÄÏãúÎ≥¥Îìú';
      else if (currentPath.includes('/todos')) title = 'Ìà¨Îëê Î¶¨Ïä§Ìä∏';
      else if (currentPath.includes('/routines')) title = 'Îç∞ÏùºÎ¶¨ Î£®Ìã¥';
      else if (currentPath.includes('/interview')) title = 'Î©¥Ï†ë ÏßàÎ¨∏';
      else if (currentPath.includes('/mypage/stats')) title = 'My ÌÜµÍ≥Ñ';
      else if (currentPath.includes('/settings')) title = 'ÌôòÍ≤ΩÏÑ§Ï†ï';
      else if (currentPath.includes('/admin')) title = 'Í¥ÄÎ¶¨Ïûê';
      pageTitle.textContent = title;
    }
  });
  /*]]>*/
</script>

</body>
</html>
